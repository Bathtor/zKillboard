/*

 DHTML Snowstorm! JavaScript-based Snow for web pages
 --------------------------------------------------------
 Version 2.0, EXPERIMENTAL DEV/WORK-IN-PROGRESS build
 (Previous rev: 1.41.20101113)
 Copyright (c) 2007, Scott Schiller. All rights reserved.
 Code provided under the BSD License:
 http://schillmania.com/projects/snowstorm/license.txt
*/
var snowStorm=function(f,e){var I;function m(a,d){isNaN(d)&&(d=0);return Math.random()*a+d}function B(a){return 1===parseInt(m(2),10)?-1*a:a}function J(){(this.excludeMobile&&!K||!this.excludeMobile)&&f.setTimeout(function(){a.start(!0)},20);a.events.remove(f,"load",J)}this.flakesMax=0;this.flakesMaxActive=1;this.flakesMinActive=14;this.flakeScale=1;this.animationInterval=42;this.excludeMobile=!0;this.flakeBottom=null;this.followMouse=!0;this.snowColor="#fff";this.snowCharacter="&bull;";this.snowStick=
!0;this.targetElement=null;this.useMeltEffect=!0;this.usePositionFixed=this.useTwinkleEffect=!1;this.useOpacity=!0;this.freezeOnBlur=!1;this.flakeRightOffset=this.flakeLeftOffset=0;this.flakeHeight=this.flakeWidth=15;this.vMaxX=0.7;this.vMaxY=0.3;this.zIndex=0;this.useScaling=!0;this.useWebFont=!1;this.use3DRotate=this.use2DRotate=!0;this.scaleOffset=80;this.webFontCharacters="%'(67jCefo".split("");this.webFontCharactersSubset=["%","'"];var a=this,k=this,w,F,x,L,M,N,y=navigator.userAgent,q=y.match(/msie/i),
p=y.match(/msie 6/i),K=y.match(/mobile/i),r=q&&"BackCompat"===e.compatMode;y.match(/(ipad|iphone|ipod)/i);var O=K||r||p,j=null,t=null,n=null,u=null,z=null,P=null,Q=0,h=1,R=1.1*h,s=1,v=0,C=!1,p=e.createElement("div"),A=null,G=null;a:{try{p.style.opacity="0.5"}catch(aa){r=!1;break a}r=!0}var W=r,r="undefined"!==typeof p.style["-ms-transform"]?"-ms-transform":null,X="undefined"!==typeof p.style.MozTransform?"MozTransform":null,Y="undefined"!==typeof p.style.OTransform?"OTransform":null,D="undefined"!==
typeof p.style.webkitTransform?"webkitTransform":null,H=null,S=!1,T=e.createDocumentFragment(),H=X||D||r||Y;this.timer=null;this.flakes=[];this.active=this.disabled=!1;this.meltFrameCount=20;this.meltFrames=[];this.types=100;this.timing={frameCount:0,timestamp:0,lastTimestamp:0,wasSlow:null,slowInterval:Math.max(50,1.1*a.animationInterval),ping:function(){a.timing.lastTimestamp=(new Date).getTime();a.timing.frameCount++>a.timing.slowInterval&&a.timing.reset()},tooSlow:function(){var c=a.timing.report()>
a.timing.slowInterval;c&&(a.timing.wasSlow=!0);return c},reset:function(c){a.timing.frameCount=0;a.timing.timestamp=(new Date).getTime()+(c||0);!1===a.timing.wasSlow&&a.flakesMaxActive<a.flakesMax-1&&(a.flakesMaxActive+=2);a.timing.wasSlow=!1},report:function(){return 1>a.timing.frameCount?0:parseInt((a.timing.lastTimestamp-a.timing.timestamp)/a.timing.frameCount,10)}};var U=function(a){a=Z.call(a);var d=a.length;E?(a[1]="on"+a[1],3<d&&a.pop()):3===d&&a.push(!1);return a},V=function(a,d){var e=a.shift(),
g=[$[d]];if(E)e[g](a[0],a[1]);else e[g].apply(e,a)},E=!f.addEventListener&&f.attachEvent,Z=Array.prototype.slice,$={add:E?"attachEvent":"addEventListener",remove:E?"detachEvent":"removeEventListener"};this.events={add:function(){V(U(arguments),"add")},remove:function(){V(U(arguments),"remove")}};this.getSnowCharacter=function(){var c=a.useWebFont?a.use2DRotate?D?a.webFontCharacters:a.webFontCharactersSubset:a.webFontCharactersSubset:null;return!c?a.snowCharacter:c[parseInt(Math.random()*c.length,
10)]};this.randomizeWind=function(){z=B(m(a.vMaxX,0.2));P=m(a.vMaxY,0.2);if(a.flakes)for(var c=a.flakes.length;c--;)a.flakes[c].active&&a.flakes[c].setVelocities()};this.scrollHandler=function(){u=a.flakeBottom?0:parseInt(f.scrollY||e.documentElement.scrollTop||e.body.scrollTop,10);isNaN(u)&&(u=0);if(!C&&!a.flakeBottom&&a.flakes)for(var c=a.flakes.length;c--;)0===a.flakes[c].active&&a.flakes[c].stick()};this.resizeHandler=function(){f.innerWidth||f.innerHeight?(j=f.innerWidth-2-a.flakeRightOffset,
n=a.flakeBottom?a.flakeBottom:f.innerHeight):(j=(e.documentElement.clientWidth||e.body.clientWidth||e.body.scrollWidth)-(!q?8:-0)-a.flakeRightOffset,n=a.flakeBottom?a.flakeBottom:e.documentElement.clientHeight||e.body.clientHeight||e.body.scrollHeight);n<e.body.scrollHeight&&(j-=16);t=parseInt(j/2,10)};this.resizeHandlerAlt=function(){j=a.targetElement.offsetLeft+a.targetElement.offsetWidth-a.flakeRightOffset;n=a.flakeBottom?a.flakeBottom:a.targetElement.offsetTop+a.targetElement.offsetHeight;t=parseInt(j/
2,10)};this.motionHandler=function(a){var d=a.x;a=a.y;var e;if(-90===v||90===v)e=d,d=a,a=e;0>z&&(z=Math.abs(z));null!==d?(90===v&&(d*=-1),0>d?(d=Math.max(-1,d)/1,h=Math.max(-R,h+1.1*d)):0<d&&(d=Math.min(1,d)/1,h=Math.min(R,h+1.1*d))):0.1<Math.abs(h)&&(h*=0.9);null!==a&&(-90===v&&(a*=-1),0>a?(a=Math.max(-1,a)/1,1>s&&(s-=a)):0<a&&(a=Math.min(1,a)/1,-1<s&&(s-=a)))};this.tiltHandler={iOS:function(c){a.motionHandler({x:c.accelerationIncludingGravity.x/8,y:c.accelerationIncludingGravity.y/8})},moz:function(c){a.motionHandler({x:-1*
c.x,y:c.y})}};this.orientationHandler={iOS:function(){v=f.orientation},moz:{}};this.freeze=function(){if(a.disabled)return!1;a.disabled=1;clearInterval(a.timer)};this.resume=function(){if(a.disabled)a.disabled=0;else return!1;a.timerInit()};this.toggleSnow=function(){a.flakes.length?(a.active=!a.active,a.active?(a.show(),a.resume()):(a.stop(),a.freeze())):a.start()};this.stop=function(){this.freeze();for(var c=this.flakes.length;c--;)this.flakes[c].hide();a.events.remove(f,"scroll",a.scrollHandler);
a.events.remove(f,"resize",a.resizeHandler);a.freezeOnBlur&&(q?(a.events.remove(e,"focusout",a.freeze),a.events.remove(e,"focusin",a.resume)):(a.events.remove(f,"blur",a.freeze),a.events.remove(f,"focus",a.resume)))};this.show=function(){for(var a=this.flakes.length;a--;)this.flakes[a].show()};this.SnowFlake=function(a,d,f,g){var b=this,k=[],p=a.useWebFont?1:0,l=a.useWebFont?3:0,r=Math.random(1);this.type=null;this.x=f||parseInt(m(j-20),10);this.y=!isNaN(g)?g:-m(n)-12;this.vY=this.vX=null;this.angle=
0;this.angleOffset=parseInt(360*Math.random(),10);this.angleMultiplier=B(2*Math.random());this.rotateDirection=B(1+B(1*Math.random()));this.vAmp=null;this.melting=!1;this.meltFrameCount=a.meltFrameCount;this.meltFrames=a.meltFrames;this.twinkleFrame=this.meltFrame=0;this.active=1;this.opacity=this.scale=this.fontSize=null;this.character=a.getSnowCharacter();this.o=A.cloneNode(!0);this.oNode=a.useWebFont?this.o.childNodes[0]:this.o;this.oNode.innerHTML=this.character;this.flakeHeight=this.flakeWidth=
null;this.visible=!1;T.appendChild(this.o);this.setType=function(d){if(b.type===d||b.melting)return!1;b.type=d;b.vAmp=1+2*(d/a.types);b.fontSize=9+d/a.types*(a.useWebFont?14:10)*a.flakeScale;b.scale=d/a.types;b.opacity=0.5+0.5*((d+1)/a.types);b.setOpacity(b.o,b.opacity);b.flakeWidth=b.fontSize+p;b.flakeHeight=b.fontSize+l;a.useWebFont||(b.oNode.style.marginBottom=-(b.flakeHeight/2.35)+r+"px",b.oNode.style.lineHeight=b.flakeHeight+4+"px");b.o.style.fontSize=b.fontSize+"px";b.o.style.width=b.flakeWidth+
"px";b.o.style.height=b.flakeHeight+"px"};this.refresh=function(a){if(isNaN(b.x)||isNaN(b.y)||!a&&b.y<-b.flakeHeight)return!1;b.o.style.left=b.x+"px";b.o.style.top=b.y+"px"};this.stick=function(){O||a.targetElement!==e.documentElement&&a.targetElement!==e.body?(b.y=n+u-b.flakeHeight-(q&&a.useWebFont?1:0),b.o.style.top=b.y+"px"):a.flakeBottom?b.o.style.top=a.flakeBottom+"px":(b.hide(),b.o.style.top="auto",b.o.style.bottom="0px",b.o.style.position="fixed",b.show())};this.vCheck=function(){0<=b.vX&&
0.2>b.vX?b.vX=0.2:0>b.vX&&-0.2<b.vX&&(b.vX=-0.2);0<=b.vY&&0.2>b.vY&&(b.vY=0.2)};this.applyTransform=function(d){if(a.use2DRotate&&b.y>=-b.flakeHeight&&(D||14<=this.fontSize)){var e=Math.abs(Math.min(3,b.angleOffset+d*b.angleMultiplier));!a.use3DRotate||!D?k.push("rotate("+d+"deg)"):(360<Math.abs(e)&&(e=0),k.push("rotate("+d+"deg) rotate3D(0,1,0,"+e+"deg)"));b.oNode.style[H]=k.join(" ");k=[]}};this.move=function(){var e=b.vX*h*b.scale,g;b.x+=e;b.y+=b.vY*b.vAmp*s;b.x>=j||j-b.x<b.flakeWidth?b.x=0:0>
e&&b.x-a.flakeLeftOffset<0-b.flakeWidth&&(b.x=j-b.flakeWidth-1);e=n+u-b.y;a.useScaling&&(g=Math.floor(Math.max(0,Math.min(a.types,e*(100/a.scaleOffset)/(n+u)*d))),b.setType(g));a.use2DRotate&&H&&(b.angle+=5*h*b.rotateDirection,360<=Math.abs(b.angle)&&(b.angle=0),b.applyTransform(b.angle));e<=b.flakeHeight?(b.active=0,a.snowStick?b.stick():b.recycle()):(a.useMeltEffect&&(b.active&&3>b.type&&!b.melting&&0.998<Math.random())&&(b.melting=!0,b.melt()),a.useTwinkleEffect&&(b.twinkleFrame?(b.twinkleFrame--,
b.o.style.visibility=b.twinkleFrame&&0===b.twinkleFrame%2?"hidden":"visible"):0.9<Math.random()&&(b.twinkleFrame=parseInt(20*Math.random(),10))));b.refresh()};this.animate=function(){b.move()};this.setVelocities=function(){b.vX=z+m(0.2*a.vMaxX,0.1);b.vY=P+m(0.2*a.vMaxY,0.1)};this.setOpacity=function(b,d){a.useOpacity&&W&&(b.style.opacity=d)};this.melt=function(){!a.useMeltEffect||!b.melting?b.recycle():b.meltFrame<b.meltFrameCount?(b.meltFrame++,b.setOpacity(b.o,b.opacity*b.meltFrames[b.meltFrame]),
b.o.style.fontSize=b.fontSize-b.fontSize*(b.meltFrame/b.meltFrameCount)+"px",a.useWebFont||(b.oNode.style.marginBottom=-(b.flakeHeight/2.35)-Math.random(1)+"px")):b.recycle()};this.show=function(){b.visible||(b.visible=!0,b.o.style.display="block")};this.hide=function(){b.visible&&(b.visible=!1,b.o.style.display="none")};this.recycle=function(e){b.hide();b.meltFrame=0;b.melting=!1;e||N<a.flakesMaxActive&&!b.active?(b.o.style.position=C?"fixed":"absolute",b.o.style.bottom="auto",b.setType(d),b.setVelocities(),
b.vCheck(),b.setOpacity(b.o,b.opacity),b.o.style.padding="0px",b.o.style.margin="0px",b.o.style.fontSize=b.fontSize+"px",b.x=parseInt(m(j-b.flakeWidth-20),10),b.y=parseInt(-1*m(n),10)-b.flakeHeight,b.refresh(!0),b.show(),b.active=1):b.active=0};this.setType(d);this.recycle(!0);this.refresh(!0)};this.snow=function(){var c=0,d=0,f=0,g=null,b,g=[],j=[],h=[],l=k.timing.tooSlow();for(b=a.flakes.length;b--;)1===a.flakes[b].active?(a.flakes[b].move(),l&&(1===a.flakes[b].active&&!a.flakes[b].melting)&&g.push(b),
c++):0===a.flakes[b].active?(d++,h.push(b)):(f++,j.push(b)),a.flakes[b].melting&&a.flakes[b].melt();N=c;c>a.flakesMaxActive&&g.length&&(b=a.flakes[g[parseInt(Math.random()*g.length,10)]],b.melting=!0);l&&(c>k.flakesMinActive&&g.length)&&(b=a.flakes[g[parseInt(Math.random()*g.length,10)]],b.melting=!0,a.timing.reset());l&&(a.flakesMaxActive>a.flakesMinActive&&a.flakesMaxActive--,h.length&&(b=a.flakes[h[parseInt(Math.random()*h.length,10)]],0===b.active&&!a.snowStick?b.recycle():b.melting=!0));!l&&
c<a.flakesMaxActive&&(g.length&&(b=a.flakes[g[parseInt(Math.random()*g.length,10)]],b.melting=!0),g=a.flakes[parseInt(m(a.flakes.length),10)],0===g.active&&(g.melting=!0));if(a.flakes.length<a.flakesMaxActive&&(a.flakes.length<a.flakesMinActive||!l))l=(new Date).getTime(),333<l-Q&&(Q=l,a.createSnow(1,!1));a.timing.ping();l=Math.floor(1E3*(a.timing.frameCount/(a.timing.lastTimestamp-a.timing.timestamp)));!isNaN(l)&&(Infinity!==l&&e.getElementById("active"))&&(e.getElementById("active").innerHTML=c+
" of "+a.flakes.length+" (max active: "+a.flakesMaxActive+"), used: "+d+", waiting: "+f+", load: "+parseInt(100*(k.timing.report()/k.timing.slowInterval),10)+"%, FPS: ~"+l+", slow: "+(a.timing.wasSlow?"true":"false"))};this.mouseMove=function(c){if(!a.followMouse)return!0;c=parseInt(c.clientX,10);c<t?h=-1.1+1.1*(c/t):(c-=t,h=1.1*(c/t))};this.createTemplate=function(){A=e.createElement("div");A.className="snowflake";G=e.createElement("div");var c=A.style,d=G.style;c.MozUserSelect="none";c.KhtmlUserSelect=
"none";c.WebkitlUserSelect="none";c.color=k.snowColor;c.margin="0px";c.padding="0px";c.position=C?"fixed":"absolute";c.fontFamily=(a.useWebFont?"WWFlakesRegular,":"")+"arial,verdana,sans-serif";c.overflow="hidden";c.fontWeight="normal";c.zIndex=k.zIndex;d.display="block";d.cursor="default";d.position="absolute";d.bottom="0px";d.left="1px";d.overflow="hidden";k.useWebFont&&A.appendChild(G)};this.createSnow=function(c,d){for(var e=0;e<c&&a.flakes.length<a.flakesMax;e++)if(a.flakes.push(new a.SnowFlake(a,
parseInt(m(k.types),10))),d||e>a.flakesMaxActive)a.flakes[a.flakes.length-1].active=-1;k.targetElement.appendChild(T)};this.timerInit=function(){a.timing.reset(a.animationInterval);a.timer=setInterval(a.snow,a.animationInterval)};this.init=function(){if(a.useWebFont){var c;if(c=!y.match(/blackberry/i)){var d;c=e.createElement("style");var h=e.implementation||{hasFeature:function(){return!1}};c.type="text/css";w.insertBefore(c,w.firstChild);d=c.sheet||c.styleSheet;c=(h.hasFeature("CSS2","")?function(a){if(!d||
!a)return!1;var b=!1;try{d.insertRule(a,0),b=!/unknown/i.test(d.cssRules[0].cssText),d.deleteRule(d.cssRules.length-1)}catch(c){}return b}:function(a){if(!d||!a)return!1;d.cssText=a;return 0!==d.cssText.length&&!/unknown/i.test(d.cssText)&&0===d.cssText.replace(/\r+|\n+/g,"").indexOf(a.split(" ")[0])})('@font-face { font-family: "font"; src: "http://zkillboard.com/wwflakes-webfont.ttf"; }')}c?(F=e.createElement("style"),I=["font-family: 'WWFlakesRegular';","src: url('http://zkillboard.com/wwflakes-webfont.eot');",
"src: local('?'), url('http://zkillboard.com/wwflakes-webfont.woff') format('woff'), url('http://zkillboard.com/wwflakes-webfont.ttf') format('truetype');","font-weight: normal;","font-style: normal;"],L="@font-face {\n"+I.join("\n")+"\n}",M=e.createTextNode(L),q?(x=e.createElement("link"),x.rel="stylesheet",x.type="text/css",x.href="wwflakes-webfont.css",w.appendChild(x)):(F.appendChild(M),w.appendChild(F))):(a.useWebFont=!1,a.use2DRotate=!1)}else a.useWebFont=!1,a.use2DRotate=!1;a.createTemplate();
for(c=0;c<a.meltFrameCount;c++)a.meltFrames.push(1-c/a.meltFrameCount);v="undefined"!==typeof f.orientation?f.orientation:0;a.randomizeWind();a.createSnow(2);a.events.add(f,"devicemotion",a.tiltHandler.iOS);a.events.add(f,"MozOrientation",a.tiltHandler.moz);a.events.add(e.body,"orientationchange",a.orientationHandler.iOS);a.events.add(f,"resize",a.resizeHandler);a.events.add(f,"scroll",a.scrollHandler);a.freezeOnBlur&&(q?(a.events.add(e,"focusout",a.freeze),a.events.add(e,"focusin",a.resume)):(a.events.add(f,
"blur",a.freeze),a.events.add(f,"focus",a.resume)));a.resizeHandler();a.scrollHandler();a.followMouse&&a.events.add(q?e:f,"mousemove",a.mouseMove);a.animationInterval=Math.max(20,a.animationInterval);a.timerInit()};this.start=function(c){if(S){if(c)return!0}else S=!0;if("string"===typeof a.targetElement&&(c=a.targetElement,a.targetElement=e.getElementById(c),!a.targetElement))throw Error('Snowstorm: Unable to get targetElement "'+c+'"');a.targetElement||(a.targetElement=!q?e.documentElement?e.documentElement:
e.body:e.body);a.targetElement!==e.documentElement&&a.targetElement!==e.body&&(a.resizeHandler=a.resizeHandlerAlt);w=e.getElementsByTagName("head")[0];a.resizeHandler();a.usePositionFixed=a.usePositionFixed&&!O;C=a.usePositionFixed;j&&(n&&!a.disabled)&&(a.init(),a.active=!0)};a.events.add(f,"load",J,!1);return this}(window,document);